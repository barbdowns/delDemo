<div class="banner" id="banner">
    <a href="/" class="banner-content">
        <%#= image_tag "logo_placeholder.png", class: "logo" %>
        DEL FHIR Client
    </a>
    <a href="/about" class="about">
        <div class="banner-about">
            About
        </div>
    </a>
</div>

<% activeVersions = Array.new %>
<% inactiveVersions = Array.new %>
<% @questionnaireVersions.each do |qv| %>
    <% qv[:status].eql?("active") ? activeVersions.append(qv) : inactiveVersions.append(qv) %>
<% end %>

<h2 class='home-header mt-5'>Search for Data Elements by ID or Text</h2>
<div class='search-container'>
    <form action="/search" accept-charset="UTF-8" method="get">
        <select name='assessment'>
            <option value=''>All Forms</option>
            <option value='' disabled>---------------</option>
            <option value='' disabled>Active Forms</option>
            <option value='' disabled>---------------</option>
            <% activeVersions.each do |av| %>
                <option value="<%= av[:id] -%>"><%= av[:name].sub("MDS30", "MDS3.0") -%></option>
            <% end %>
            <option value='' disabled>---------------</option>
            <option value='' disabled>Inactive Forms</option>
            <option value='' disabled>---------------</option>
            <% inactiveVersions.each do |iv| %>
                <option value="<%= iv[:id] -%>"><%= iv[:name].sub("MDS30", "MDS3.0") -%></option>
            <% end %>
        </select>
        <div class="input-group">
            <input type="text" name="input" class="form-control" placeholder="DEL Search" 
                    aria-label="DEL Search" aria-describedby="basic-addon2">
            <div class="input-group-append">
                <button class="btn btn-primary" type="submit">Search</button>
            </div>
        </div>
    </form>
</div>

<div class='qop-container-blue'>
    <div class="home-cards-container">
        <h2 class="home-header">Choose an active DEL assessment to fill out</h2>
        <div class="home-cards">
            <% activeVersions.each do |av| %>
                <% if av[:status].eql?("active") %>
                    <a href="/questionnaire?version=<%= av[:id] -%>&loinc=false" 
                            class="card active-cards <%= "no-loinc" if av[:code].nil? %>">
                        <h5 class="card-header"><%= av[:name].sub("MDS30", "MDS3.0") -%></h5>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-subtitle mb-2">
                                <%= av[:title] -%>
                            </h6>
                            <p class="mt-auto">
                            <% if av[:code].nil? %>
                                No LOINC Support
                            <% else %>
                                LOINC Supported (<%= av[:code][0]["code"] -%>)
                            <% end %>
                            </p>
                            <small class="card-text">
                                Published by <%= av[:publisher] -%>
                            </small>
                        </div>
                    </a>
                <% end %>
            <% end %>
        </div>
    </div>

    <div id="inactive-card-container" class="home-cards-container collapse">
        <h2 class="home-header">Choose an inactive DEL assessment to fill out</h2>
        <div class="home-cards">
            <% inactiveVersions.each do |iv| %>
                <a href="/questionnaire?version=<%= iv[:id] -%>&loinc=false" 
                        class="card active-cards <%= "no-loinc" if iv[:code].nil? %>">
                    <h5 class="card-header"><%= iv[:name].sub("MDS30", "MDS3.0") -%></h5>
                    <div class="card-body d-flex flex-column">
                        <h6 class="card-subtitle mb-2"><%= iv[:title] -%></h6>
                        <p class="mt-auto">
                            <% if iv[:code].nil? %>
                                No LOINC Support
                            <% else %>
                                LOINC Supported (<%= iv[:code][0]["code"] -%>)
                            <% end %>
                        </p>
                        <small class="card-text">
                            Published by <%= iv[:publisher] -%>
                        </small>
                    </div>
                </a>
            <% end %>
        </div>
    </div>

    <div class='assessment-toggles'>
        <small class="toggle-section-codes">
            Currently using 
                <strong class="current-code-cms">CMS</strong> 
            codes
            <br>
            <a class='code-toggle'>Switch to LOINC codes</a>
        </small>

        <small class="toggle-section-inactive">Looking for an inactive assessment version?
            <br>
            <a data-toggle="collapse" href="#inactive-card-container" 
                    aria-expanded="false" aria-controls="inactive-card-container">
                Toggle inactive section
            </a>
        </small>
    </div>
</div>